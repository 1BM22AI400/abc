import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error as mse
from sklearn.preprocessing import LabelEncoder

data=pd.read_csv("/content/Iris.csv")
x=data.iloc[:,1:-1]
y=data.iloc[:,-1]
enc=LabelEncoder()
y=enc.fit_transform(y)
errors=[]
set=[]
x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.2,random_state=43)
features=x.columns
featureselected=[]
i=0
for feature in features:
  i=i+1
  featureselected.append(feature)
  x_train_subset=x_train[featureselected]
  x_test_subset=x_test[featureselected]
  model=LinearRegression()
  model.fit(x_train_subset,y_train)
  predictions=model.predict(x_test_subset)
  error=mse(y_test,predictions)
  print(f"Iteration={i},Features={np.array(x_train_subset.columns)},error={error}")
  set.append(x_train_subset.columns)
  errors.append(error)
min_error=np.argmin(errors)
print(f"best subset={np.array(set[min_error])}")
